# 产品需求文档 (PRD) - 私人桌游规则导师

## 1. 产品概述
**产品名称**：私人桌游规则导师 (Board Game Rule Tutor)
**产品定位**：运行在移动端浏览器（适配 Android/iOS）的 React Web 应用，旨在作为用户的“私人桌游规则导师”。
**核心价值**：用户上传桌游规则书（PDF 或图片），应用通过 AI 阅读并理解规则，然后以语音（TTS）+ 文字的形式，分阶段、交互式地向用户讲解规则。

## 2. 用户画像
- 桌游新手，不愿意阅读冗长的规则书。
- 资深玩家，需要快速回顾或学习新游戏规则。
- 聚会场景下的主持人，需要快速教会其他人玩游戏。

## 3. 核心功能模块

### 3.1 文件处理
- **PDF 解析与渲染**：支持上传 PDF 文件，并在应用内预览。
- **图片转 PDF**：支持上传多张图片，自动合并为 PDF 文件进行处理。

### 3.2 联网搜索
- **规则书搜索**：内置搜索功能，通过 Google/Bing 等搜索引擎查找并下载桌游规则书 PDF。

### 3.3 AI 智能讲解
- **多模型支持**：
    - 内置 API（默认）：提供 2-3 种预设模型。
    - 自定义 API：支持用户配置 OpenAI 格式的 API Endpoint 和 Key。
- **状态机讲解模式**：遵循严格的“讲解流程状态表”，分阶段讲解，禁止堆砌信息。
- **交互式问答**：用户可随时提问（语音/文字），AI 基于规则书内容回答。

### 3.4 音频管理 (TTS)
- **语音生成**：
    - **云端 TTS（默认推荐）**：支持阿里云/华为云 TTS，提供接近真人的自然语音体验（需部署轻量级后端或配置 API Key）。
    - **浏览器原生 TTS（降级/离线）**：无网络或未配置云端 TTS 时自动切换。
- **播放控制**：播放、暂停、停止、倍速控制 (0.8x - 2.0x)。

## 4. UI/UX 设计

### 4.1 首页
- **游戏列表**：中间显示已上传/学习过的桌游规则名称列表。
- **新增入口**：底部固定按钮“新增桌游规则”。
- **设置入口**：右上角齿轮图标。

### 4.2 规则添加页
- **文件上传**：大按钮“上传文件”（支持文件选择/相机拍照）。
- **搜索添加**：底部提供文字输入框和“搜索规则”按钮。
- **流程**：上传/下载成功后，自动跳转至讲解页。

### 4.3 讲解页 (核心界面)
- **顶部栏**：
    - 游戏名称（点击重命名）。
    - 添加文件图标（追加规则材料）。
    - 阅读原文图标（打开 PDF 阅读器，支持缩放/翻页）。
    - 语速控制（0.8x - 2.0x）。
- **中部聊天区**：
    - 类微信气泡式对话界面。
    - AI 消息自动播放语音。
    - 每个 AI 气泡带独立播放控制条（播放/暂停/停止）。
- **快捷指令栏**（位于输入框上方）：
    - [讲解规则]：触发 AI 开始/继续讲解流程。
    - [没懂]：发送“这段不太明白，讲清楚些或举个例子”。
    - [继续]：发送“继续”。
- **底部输入栏**：
    - 文本输入框。
    - 语音输入按钮（语音转文字）。

## 5. 核心讲解提示词 (System Prompt)
*(此处引用用户提供的详细 Prompt，包含核心行为准则、讲解流程状态表、语气准则等)*

## 6. 非功能需求
- **网络适应性**：**核心需求** - 所有功能（AI 对话、TTS、文件处理）必须在中国大陆网络环境下无障碍使用（无须 VPN）。
- **移动端适配**：响应式布局，完美适配 iOS Safari 和 Android Chrome。
- **性能**：PDF 加载迅速，TTS 响应延迟低。
- **隐私**：用户上传的规则书和 API Key 仅在本地或必要的 API 请求中使用。
